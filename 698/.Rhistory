mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJ = (MEDINC - ((RPPALL / 100)* MEDINC)),
INCADJ = MEDINC + ADJ) %>%
mutate(HAI = (INCADJ / QINC)*100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJ = (MEDINC - ((RPPALL / 100)* MEDINC)),
INCADJ = MEDINC + ADJ,
ADJHAI = (INCADJ / QINC)*100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
ALLHAI = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
HAIRNT = (AINCRNT / QINC)*100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = mean(AINCRNT, AINCALL)*(IPD/100),
HAIIPD = (ADJIPD / QINC)*100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
HAIIPD = (ADJIPD / QINC)*100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99999 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
HAIRAW = (MEDINC / QINCRAW) * 100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99999 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HH4 = 2.53,
DEBTMV = (20000/HH4),
DEBTED = 9664*HH4,
DEBTIL = 9609*HH4,
DEBTCC = 3500*HH4,
DEBTOC = 10000*HH4,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99999 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HH4 = 2.53,
DEBTMV = (20000/HH4),
DEBTED = 9664*HH4,
DEBTIL = 9609*HH4,
DEBTCC = 3500*HH4,
DEBTOC = 10000/HH4,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99999 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HH4 = 2,
DEBTMV = (20000/HH4),
DEBTED = 9664*HH4,
DEBTIL = 9609*HH4,
DEBTCC = 3500*HH4,
DEBTOC = 10000/HH4,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99999 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HH4 = 2.53,
DEBTMV = (20000/HH4),
DEBTED = 9664*HH4,
DEBTIL = 9609*HH4,
DEBTCC = 3500*HH4,
DEBTOC = 10000/HH4,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99999 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HHSIZE = 2.53,
DEBTMV = (20000/HHSIZE),
DEBTED = 9664*HHSIZE,
DEBTIL = 9609*HHSIZE,
DEBTCC = 3500*HHSIZE,
DEBTOC = 10000*HHSIZE,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC,
AQINC30 =  PMT * (100/30) * 12,
AINCDBT = ((AINCRNT + AINCALL / 2) - DEBTS) / AQINC30) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99999 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HHSIZE = 2.53,
DEBTMV = (20000/HHSIZE),
DEBTED = 9664*HHSIZE,
DEBTIL = 9609*HHSIZE,
DEBTCC = 3500*HHSIZE,
DEBTOC = 10000*HHSIZE,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC,
AQINC30 =  PMT * (100/30) * 12,
AINCDBT = ((AINCRNT + AINCALL / 2) - DEBTS)) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99999 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HHSIZE = 2.53,
DEBTMV = (20000/HHSIZE),
DEBTED = 9664*HHSIZE,
DEBTIL = 9609*HHSIZE,
DEBTCC = 3500*HHSIZE,
DEBTOC = 10000*HHSIZE,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC,
AQINC30 =  PMT * (100/30) * 12,
AINCDBT = ((AINCRNT + AINCALL / 2) - DEBTS),
HAIDBT = AINCDBT / AQINC30) %>%
mutate(HAILEN = (AINCALL / AQINC30)*100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HHSIZE = 2.53,
DEBTMV = (20000/HHSIZE),
DEBTED = 9664*HHSIZE,
DEBTIL = 9609*HHSIZE,
DEBTCC = 3500*HHSIZE,
DEBTOC = 10000*HHSIZE,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC,
AQINC30 =  PMT * (100/30) * 12,
AINCDBT = ((AINCRNT + AINCALL / 2) - DEBTS),
HAIDBT = AINCDBT / AQINC30) %>%
mutate(PMT3DP = MEDVAL * 0.97 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
AQINC60 = PMT * (100/60)*12,
HAIDAN = (AINCALL / AQINC50)*100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
filter(year == 2019) %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HHSIZE = 2.53,
DEBTMV = (20000/HHSIZE),
DEBTED = 9664*HHSIZE,
DEBTIL = 9609*HHSIZE,
DEBTCC = 3500*HHSIZE,
DEBTOC = 10000*HHSIZE,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC,
AQINC30 =  PMT * (100/30) * 12,
AINCDBT = ((AINCRNT + AINCALL / 2) - DEBTS),
HAIDBT = AINCDBT / AQINC30) %>%
mutate(PMT3DP = MEDVAL * 0.97 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
AQINC60 = PMT * (100/60)*12,
HAIDAN = (AINCALL / AQINC60)*100) %>% View()
# RPP Adjusted Income (Real Wage) HAI
df %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HHSIZE = 2.53,
DEBTMV = (20000/HHSIZE),
DEBTED = 9664*HHSIZE,
DEBTIL = 9609*HHSIZE,
DEBTCC = 3500*HHSIZE,
DEBTOC = 10000*HHSIZE,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC,
AQINC30 =  PMT * (100/30) * 12,
AINCDBT = ((AINCRNT + AINCALL / 2) - DEBTS),
HAIDBT = AINCDBT / AQINC30) %>%
mutate(PMT3DP = MEDVAL * 0.97 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
AQINC60 = PMT * (100/60)*12,
HAILEN = (AINCALL / AQINC60)*100) %>% View()
df[-["X"]]
df[-"X"]]
df[-"X"]
df["X"]
drop(df["X"])
df %>%
dplyr::select(-X)
View(merged.df)
# All HAI Estimates
df.complete <- df %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HHSIZE = 2.53,
DEBTMV = (20000/HHSIZE),
DEBTED = 9664*HHSIZE,
DEBTIL = 9609*HHSIZE,
DEBTCC = 3500*HHSIZE,
DEBTOC = 10000*HHSIZE,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC,
AQINC30 =  PMT * (100/30) * 12,
AINCDBT = ((AINCRNT + AINCALL / 2) - DEBTS),
# HAI Adjusted for Average American Household Debts
HAIDBT = AINCDBT / AQINC30) %>%
mutate(PMT3DP = MEDVAL * 0.97 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
AQINC60 = PMT * (100/60)*12,
# Lenient Lending Practices HAI
#(60% of monthly income on mortgage is acceptable with 3% DP)
HAILEN = (AINCALL / AQINC60)*100) %>% View()
# All HAI Estimates
df.fin <- df %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HHSIZE = 2.53,
DEBTMV = (20000/HHSIZE),
DEBTED = 9664*HHSIZE,
DEBTIL = 9609*HHSIZE,
DEBTCC = 3500*HHSIZE,
DEBTOC = 10000*HHSIZE,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC,
AQINC30 =  PMT * (100/30) * 12,
AINCDBT = ((AINCRNT + AINCALL / 2) - DEBTS),
# HAI Adjusted for Average American Household Debts
HAIDBT = AINCDBT / AQINC30) %>%
mutate(PMT3DP = MEDVAL * 0.97 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
AQINC60 = PMT * (100/60)*12,
# Lenient Lending Practices HAI
#(60% of monthly income on mortgage is acceptable with 3% DP)
HAILEN = (AINCALL / AQINC60)*100)
