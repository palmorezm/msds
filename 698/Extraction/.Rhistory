df.fin %>%
filter(MEDINC >= 50000) %>%
group_by(GeoFips, GeoName) %>%
summarise(AVGHAIRNT = median(HAIRNT)) %>%
filter(AVGHAIRNT >= 200) %>% View()
library(dplyr)
library(tidyr)
df <- read.csv("https://raw.githubusercontent.com/palmorezm/msds/main/698/Data/compiled.csv")
# Change Data Types to Numeric
df[4:length(df)] <- sapply(df[4:length(df)], as.numeric)
df <- df %>%
dplyr::select(-X)
df.fin %>%
filter(MEDINC >= 50000) %>%
group_by(GeoFips, GeoName) %>%
summarise(AVGHAIRNT = median(HAIRNT)) %>%
filter(AVGHAIRNT >= 200) %>% View()
# All HAI Estimates
df.fin <- df %>%
mutate(IR = 0.035,
PMT = MEDVAL * 0.8 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINC = PMT * 4 * 12,
HAI = (MEDINC / QINC) * 100) %>%
mutate(ADJALL = (MEDINC - ((RPPALL / 100)* MEDINC)),
AINCALL = MEDINC + ADJALL,
# Real Wage HAI:
HAIRW = (AINCALL / QINC)*100) %>%
mutate(ADJRNT = (MEDINC - ((RPPRENT / 100)* MEDINC)),
AINCRNT = MEDINC + ADJRNT,
# Rent Adjusted HAI:
HAIRNT = (AINCRNT / QINC)*100) %>%
mutate(ADJIPD = (AINCRNT + AINCALL / 2)*(IPD/100),
# IPD Projected HAI:
HAIIPD = (ADJIPD / QINC)*100) %>%
mutate(PMTRAW = MEDVAL * 0.99 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
QINCRAW = PMTRAW * 4 * 12,
# Raw HAI at 20% Down Payment:
HAIRAW = (MEDINC / QINCRAW) * 100) %>%
mutate(HHSIZE = 2.53,
DEBTMV = (20000/HHSIZE),
DEBTED = 9664*HHSIZE,
DEBTIL = 9609*HHSIZE,
DEBTCC = 3500*HHSIZE,
DEBTOC = 10000*HHSIZE,
DEBTS = DEBTMV + DEBTED + DEBTIL + DEBTCC + DEBTOC,
AQINC30 =  PMT * (100/30) * 12,
AINCDBT = ((AINCRNT + AINCALL / 2) - DEBTS),
# HAI Adjusted for Average American Household Debts
HAIDBT = AINCDBT / AQINC30) %>%
mutate(PMT3DP = MEDVAL * 0.97 * (IR / 12)/(1 - (1/(1 + IR/12)^360)),
AQINC60 = PMT * (100/60)*12,
# Lenient Lending Practices HAI
#(60% of monthly income on mortgage is acceptable with 3% DP)
HAILEN = (AINCALL / AQINC60)*100)
df.fin %>%
filter(MEDINC >= 50000) %>%
group_by(GeoFips, GeoName) %>%
summarise(AVGHAIRNT = median(HAIRNT)) %>%
filter(AVGHAIRNT >= 200) %>% View()
View(df.fin)
df.fin %>%
filter(MEDINC >= 50000) %>%
group_by(GeoFips, GeoName) %>%
summarise(AVGHAIRNT = median(HAIRNT)) %>%
filter(AVGHAIRNT >= 135) %>% View()
df.fin %>%
filter(MEDINC >= 50000) %>%
group_by(GeoFips, GeoName) %>%
summarise(AVGHAIRNT = median(HAIRNT)) %>%
filter(AVGHAIRNT >= 140) %>% View()
View(df.fin)
df.fin %>%
group_by(GeoFips, GeoName, MEDINC) %>%
summarize(NatAvg = mean(MEDINC))
df.fin %>%
summarize(NatAvg = mean(MEDINC))
df.fin %>%
filter(year == 2019) %>%
summarize(NatAvg = mean(MEDINC))
df.fin %>%
filter(GeoFips == 31540) %>% View()
df.fin %>%
filter(GeoFips == 31540 & 40060) %>% View()
df.fin %>%
filter(GeoFips == 31540 & GeoFips == 40060) %>% View()
df.fin %>%
filter(GeoFips == c(31540, 40060)) %>% View()
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>% View()
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoFips))
library(ggplot2)
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoFips))
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName))
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName)) +
geom_smooth(aes(col = GeoName))
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName)) +
geom_smooth(aes(col = GeoName))
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT)) +
geom_smooth(aes(col = GeoName, fill = GeoName))
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT, fill = "white")) +
geom_smooth(aes(col = GeoName, fill = GeoName))
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT) fill = "white") +
geom_smooth(aes(col = GeoName, fill = GeoName))
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT) fill = GeoName) +
geom_smooth(aes(col = GeoName, fill = GeoName))
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT, alpha = .25)) +
geom_smooth(aes(col = GeoName, fill = GeoName))
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT, alpha = .5)) +
geom_smooth(aes(col = GeoName, fill = GeoName), alpha = .25)
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT, alpha = .5)) +
geom_smooth(aes(col = GeoName, fill = GeoName), alpha = .05)
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT), alpha = .5) +
geom_smooth(aes(col = GeoName, fill = GeoName), alpha = .05)
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT), alpha = .5, shape = 24) +
geom_smooth(aes(col = GeoName, fill = GeoName), alpha = .05)
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT), alpha = .5, shape = 21) +
geom_smooth(aes(col = GeoName, fill = GeoName), alpha = .05)
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = "grey12", size = HAIRNT), alpha = .5, shape = 21) +
geom_smooth(aes(col = GeoName, fill = GeoName), alpha = .05)
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT), alpha = .5, shape = 21) +
geom_smooth(aes(col = GeoName, fill = GeoName), alpha = .05)
df.fin %>%
filter(GeoFips == 31540 | GeoFips == 40060) %>%
ggplot(aes(year, MEDINC)) +
geom_point(aes(col = GeoName, size = HAIRNT), alpha = .99, shape = 21) +
geom_smooth(aes(col = GeoName, fill = GeoName), alpha = .05)
